<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ServiPlus - Cambio de Aceite</title>
    <link rel="stylesheet" href="solicitud_aceite.css">
</head>
<body>
    <header class="header-back">
        <button onclick="history.back()" class="btn-back">
            <img src="img/icon_arrow_back.svg" alt="Volver">
        </button>
        <h1>Cambio de aceite</h1>
    </header>

    <main class="form-container">
        <form id="formCambioAceite" hx-post="/api/servicios/cambio-aceite" hx-swap="innerHTML" hx-target="#resultado">
            
            <!-- Paso 1: Datos del vehículo -->
            <section class="form-section" id="paso1">
                <h2>Datos de tu vehículo</h2>
                
                <div class="input-group">
                    <label for="marca">Marca</label>
                    <select id="marca" name="marca" required>
                        <option value="">Selecciona...</option>
                        <option value="toyota">Toyota</option>
                        <option value="nissan">Nissan</option>
                        <option value="hyundai">Hyundai</option>
                        <option value="kia">Kia</option>
                        <option value="chevrolet">Chevrolet</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="modelo">Modelo</label>
                    <input type="text" id="modelo" name="modelo" placeholder="Ej: Corolla" required>
                </div>

                <div class="input-group">
                    <label for="anio">Año</label>
                    <input type="number" id="anio" name="anio" min="1990" max="2025" placeholder="2020" required>
                </div>

                <button type="button" class="btn-primary" onclick="irPaso2()">Siguiente</button>
            </section>

            <!-- Paso 2: Selección de aceite -->
            <section class="form-section hidden" id="paso2">
                <h2>Selecciona el aceite</h2>
                
                <div class="info-box">
                    <img src="img/icon_info.svg" alt="Info">
                    <p>Los productos serán enviados a tu domicilio por nuestro proveedor</p>
                </div>

                <div class="product-list" id="listaAceites">
                    <!-- Se cargará dinámicamente desde la API -->
                    <div class="product-item">
                        <img src="img/products/castrol_5w30.jpg" alt="Castrol 5W30">
                        <div class="product-info">
                            <h4>Castrol Edge 5W-30</h4>
                            <p class="product-specs">Sintético - 4 litros</p>
                            <p class="product-price">S/189.00</p>
                        </div>
                        <input type="radio" name="aceite" value="aceite_001" required>
                    </div>

                    <div class="product-item">
                        <img src="img/products/mobil_10w40.jpg" alt="Mobil 10W40">
                        <div class="product-info">
                            <h4>Mobil Super 10W-40</h4>
                            <p class="product-specs">Semi-sintético - 4 litros</p>
                            <p class="product-price">S/149.00</p>
                        </div>
                        <input type="radio" name="aceite" value="aceite_002" required>
                    </div>
                </div>

                <h3 class="mt-3">Filtros y accesorios</h3>
                <div class="checkbox-list">
                    <label class="checkbox-item">
                        <input type="checkbox" name="filtro_aceite" value="true" checked>
                        <span>Filtro de aceite - S/35.00</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="bujias" value="true">
                        <span>Bujías (4 unid.) - S/80.00</span>
                    </label>
                </div>

                <div class="resumen-productos">
                    <p>Subtotal productos: <strong id="subtotalProductos">S/224.00</strong></p>
                </div>

                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="irPaso1()">Atrás</button>
                    <button type="button" class="btn-primary" onclick="irPaso3()">Siguiente</button>
                </div>
            </section>

            <!-- Paso 3: Ubicación y fecha -->
            <section class="form-section hidden" id="paso3">
                <h2>¿Dónde y cuándo?</h2>
                
                <div class="input-group">
                    <label for="direccion">Dirección</label>
                    <input type="text" id="direccion" name="direccion" placeholder="Jr. Los Cedros 123, San Isidro" required>
                    <button type="button" class="btn-map" onclick="abrirMapa()">
                        <img src="img/icon_map.svg" alt="Mapa"> Usar ubicación actual
                    </button>
                </div>

                <div class="input-group">
                    <label for="referencia">Referencia</label>
                    <input type="text" id="referencia" name="referencia" placeholder="Casa amarilla, portón negro">
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label for="fecha">Fecha</label>
                        <input type="date" id="fecha" name="fecha" required>
                    </div>
                    <div class="input-group">
                        <label for="hora">Hora</label>
                        <select id="hora" name="hora" required>
                            <option value="">Selecciona...</option>
                            <option value="09:00">09:00 AM</option>
                            <option value="10:00">10:00 AM</option>
                            <option value="11:00">11:00 AM</option>
                            <option value="14:00">02:00 PM</option>
                            <option value="15:00">03:00 PM</option>
                            <option value="16:00">04:00 PM</option>
                        </select>
                    </div>
                </div>

                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="irPaso2()">Atrás</button>
                    <button type="button" class="btn-primary" onclick="irPaso4()">Siguiente</button>
                </div>
            </section>

            <!-- Paso 4: Confirmación y pago -->
            <section class="form-section hidden" id="paso4">
                <h2>Resumen del servicio</h2>
                
                <div class="summary-box">
                    <div class="summary-item">
                        <span>Productos (aceite + filtro)</span>
                        <strong>S/224.00</strong>
                    </div>
                    <div class="summary-item">
                        <span>Comisión ServiPlus</span>
                        <strong>S/50.00</strong>
                    </div>
                    <div class="summary-divider"></div>
                    <div class="summary-total">
                        <span>Total a pagar ahora</span>
                        <strong>S/274.00</strong>
                    </div>
                </div>

                <div class="info-box warning">
                    <img src="img/icon_alert.svg" alt="Importante">
                    <p>El mecánico cobrará directamente por la mano de obra (aprox. S/30-50)</p>
                </div>

                <div class="payment-methods">
                    <h3>Método de pago</h3>
                    <label class="payment-option">
                        <input type="radio" name="metodo_pago" value="tarjeta" checked>
                        <img src="img/icon_card.svg" alt="Tarjeta">
                        <span>Tarjeta de débito/crédito</span>
                    </label>
                    <label class="payment-option">
                        <input type="radio" name="metodo_pago" value="yape">
                        <img src="img/icon_yape.svg" alt="Yape">
                        <span>Yape</span>
                    </label>
                    <label class="payment-option">
                        <input type="radio" name="metodo_pago" value="plin">
                        <img src="img/icon_plin.svg" alt="Plin">
                        <span>Plin</span>
                    </label>
                </div>

                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="irPaso3()">Atrás</button>
                    <button type="submit" class="btn-primary btn-large">
                        <img src="img/icon_lock.svg" alt="Pagar"> Pagar S/274.00
                    </button>
                </div>
            </section>

            <div id="resultado"></div>
        </form>
    </main>

    <script src="solicitud_aceite.js"></script>
</body>
</html>